# üîí FSTEC Excel Search MCP Server

MCP —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–æ–∏—Å–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –§–°–¢–≠–ö (vullist.xlsx).

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **search_vulnerabilities** - –ü–æ–∏—Å–∫ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (–Ω–∞–∑–≤–∞–Ω–∏–µ –ü–û, –æ–ø–∏—Å–∞–Ω–∏–µ, –≤–µ–Ω–¥–æ—Ä)
- **get_vulnerability_details** - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É BDU

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10+
- –§–∞–π–ª `vullist.xlsx` (—Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è —Å [bdu.fstec.ru](https://bdu.fstec.ru/files/documents/vullist.xlsx))

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
uv sync
# –∏–ª–∏
pip install -e .
```

2. –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª `vullist.xlsx` —Å —Å–∞–π—Ç–∞ –§–°–¢–≠–ö –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞.

3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```bash
cp .env.example .env
```

## üöÄ –ó–∞–ø—É—Å–∫

```bash
uv run python server.py
# –∏–ª–∏
python server.py
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://0.0.0.0:8000/mcp`

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|--------------|
| `PORT` | –ü–æ—Ä—Ç MCP —Å–µ—Ä–≤–µ—Ä–∞ | `8000` |
| `HOST` | –•–æ—Å—Ç MCP —Å–µ—Ä–≤–µ—Ä–∞ | `0.0.0.0` |
| `VULLIST_PATH` | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É vullist.xlsx | `vullist.xlsx` |

## üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

### `search_vulnerabilities` - –ü–æ–∏—Å–∫ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

–ò—â–µ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –≤ –ø–æ–ª—è—Ö: –ù–∞–∑–≤–∞–Ω–∏–µ –ü–û, –û–ø–∏—Å–∞–Ω–∏–µ, –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏, –í–µ–Ω–¥–æ—Ä.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `query` (str, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –ü–æ–∏—Å–∫–æ–≤–∞—è —Ñ—Ä–∞–∑–∞
- `limit` (int, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π) - –ú–∞–∫—Å–∏–º—É–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 5)

**–ü—Ä–∏–º–µ—Ä—ã:**
```
search_vulnerabilities(query="nginx", limit=10) # –Ω–∞–π–¥—ë—Ç 10 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ nginx
search_vulnerabilities(query="nginx 1.5.6")  # –Ω–∞–π–¥—ë—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–∏ nginx –∏–º–µ–Ω–Ω–æ –¥–ª—è –≤–µ—Ä—Å–∏–∏ 1.5.6
search_vulnerabilities(query="buffer overflow") # –Ω–∞–π–¥—ë—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É "buffer overflow"
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –°–ø–∏—Å–æ–∫ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π —Å ID, –Ω–∞–∑–≤–∞–Ω–∏–µ–º, —É—Ä–æ–≤–Ω–µ–º –æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

### `get_vulnerability_details` - –î–µ—Ç–∞–ª–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

–ü–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É BDU.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `bdu_id` (str, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (—Ñ–æ—Ä–º–∞—Ç: BDU:20xx-xxxxx)

**–ü—Ä–∏–º–µ—Ä:**
```
get_vulnerability_details(bdu_id="BDU:2014-00001") # –Ω–∞–π–¥—ë—Ç —É—è–∑–≤–∏–º–æ—Å—Ç—å –ø–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É BDU:2014-00001
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ, –º–µ—Ä—ã –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é, CVSS –æ—Ü–µ–Ω–∫–∏, —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
fstec-excel-search/
‚îú‚îÄ‚îÄ mcp_instance.py          # –ï–¥–∏–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä FastMCP
‚îú‚îÄ‚îÄ server.py                # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ pyproject.toml           # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ .env.example             # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ env_options.json         # –û–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ mcp-server-catalog.yaml  # –ö–∞—Ç–∞–ª–æ–≥ MCP —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ mcp_tools.json           # JSON –æ–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ README.md                # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ vullist.xlsx             # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –§–°–¢–≠–ö (—Å–∫–∞—á–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ)
‚îî‚îÄ‚îÄ tools/
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îú‚îÄ‚îÄ utils.py             # –£—Ç–∏–ª–∏—Ç—ã –∏ –∑–∞–≥—Ä—É–∑—á–∏–∫ –¥–∞–Ω–Ω—ã—Ö
    ‚îú‚îÄ‚îÄ search_vulnerabilities.py
    ‚îî‚îÄ‚îÄ get_vulnerability_details.py
```

## üìù –°—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** "–ü—Ä–æ–≤–µ—Ä—å —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –¥–ª—è Apache"
2. **–ê–≥–µ–Ω—Ç:** –≤—ã–∑—ã–≤–∞–µ—Ç `search_vulnerabilities(query="Apache", limit=10)`
3. **–°–µ—Ä–≤–µ—Ä:** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
4. **–ê–≥–µ–Ω—Ç:** "–ù–∞–π–¥–µ–Ω–æ 5 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π. –°–∞–º–∞—è –æ–ø–∞—Å–Ω–∞—è - BDU:2024-12345"
5. **–ê–≥–µ–Ω—Ç:** –≤—ã–∑—ã–≤–∞–µ—Ç `get_vulnerability_details(bdu_id="BDU:2024-12345")`
6. **–°–µ—Ä–≤–µ—Ä:** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –º–µ—Ä—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ **read-only** (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ)
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ Excel-—Ñ–∞–π–ª–∞ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ
- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ RAM –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–î–∞–Ω–Ω—ã–µ –æ —É—è–∑–≤–∏–º–æ—Å—Ç—è—Ö –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –§–°–¢–≠–ö –†–æ—Å—Å–∏–∏: https://bdu.fstec.ru
